<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camel="http://camel.apache.org/schema/spring"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
			http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
			http://camel.apache.org/schema/spring 
			http://camel.apache.org/schema/spring/camel-spring.xsd">

	<bean name="web-server" class="org.eclipse.jetty.server.Server"
		init-method="start" destroy-method="stop">
		<property name="connectors"> 
			<list>
				<bean name="connector-1"
					class="org.eclipse.jetty.server.nio.SelectChannelConnector">
					<property name="host" value="0.0.0.0" />
					<property name="port" value="8383" />
				</bean>
			</list>
		</property>
		<property name="handler">
			<bean id="handlers" class="org.eclipse.jetty.server.handler.HandlerList">
				<property name="handlers">
					<list>
						<bean class="org.eclipse.jetty.servlet.ServletContextHandler">
							<property name="contextPath" value="/" />
							<property name="sessionHandler">
								<bean class="org.eclipse.jetty.server.session.SessionHandler" />
							</property>
							<property name="servletHandler">
								<bean class="org.eclipse.jetty.servlet.ServletHandler">
									<property name="servlets">
										<list>
											<bean class="org.eclipse.jetty.servlet.ServletHolder">
												<property name="name" value="DefaultServlet" />
												<property name="servlet">
													<bean class="org.eclipse.jetty.servlet.DefaultServlet" />
												</property>
											</bean>
										</list>
									</property>
									<property name="servletMappings">
										<list>
											<bean class="org.eclipse.jetty.servlet.ServletMapping">
												<property name="pathSpecs">
													<list>
														<value>/*</value>
													</list>
												</property>
												<property name="servletName" value="DefaultServlet" />
											</bean>
										</list>
									</property>
									<property name="filters">
										<list>
											<bean class="org.eclipse.jetty.servlet.FilterHolder">
												<property name="name" value="WicketFilter" />
												<property name="filter">
													<bean class="org.mokai.admin.wicket.SpringWicketFilter">
														<property name="applicationFactory"><ref bean="applicationFactory" /></property>
													</bean>
												</property>
											</bean>
										</list>
									</property>
									<property name="filterMappings"> 
										<list>
											<bean class="org.eclipse.jetty.servlet.FilterMapping">
												<property name="pathSpecs">
													<list>
														<value>/*</value>
													</list>
												</property>
												<property name="filterName" value="WicketFilter" />
											</bean>
										</list>
									</property>
								</bean>
							</property>
						</bean>
					</list>
				</property>
			</bean>
		</property>
	</bean>
	
	<bean name="applicationFactory" class="org.mokai.admin.wicket.SpringWebApplicationFactory">
		<property name="webApplication"><ref bean="webApplication" /></property>
	</bean>
	
	<bean name="webApplication" class="org.mokai.admin.WicketApplication">
		<property name="routingContext"><ref bean="routingContext" /></property>
		<property name="objectTypeRegistry"><ref bean="objectTypeRegistry" /></property>
		<property name="connectorConfiguration"><ref bean="connectorConfiguration" /></property>
		<property name="queueConfiguration"><ref bean="queueConfiguration" /></property>
	</bean>
</beans>